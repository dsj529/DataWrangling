#!/usr/bin/env python
# -*- coding: utf-8 -*-
import xml.etree.ElementTree as ET
import pprint
"""
Your task is to explore the data a bit more.
The first task is a fun one - find out how many unique users
have contributed to the map in this particular area!

The function process_map should return a set of unique user IDs ("uid")
"""

def get_user(element):
    return


def process_map(filename):
    users = set()
    counter = 0
    for _, element in ET.iterparse(filename):
        if counter == 1900000:
            break
        if counter%20000 == 0:
            print "I'm here: ", counter
        if 'uid' in element.attrib:
            users.add(element.attrib['uid'])
        counter += 1
    return users


def test():

    users = process_map('c:/users/dsj/documents/coding/data wrangling (mongodb)/case study/dresden_germany.osm')
    print users, len(users)

if __name__ == "__main__":
    test()
    
"""
Output: set(['2628171', '500993', '1758800', '35787', '23448', '1983994', '1707027', '115816', '2161991', 
'767984', '671876', '526507', '1879543', '130862', '74831', '2438414', '565924', '139557', '404532', '31911',
 '603733', '465085', '74493', '807322', '63730', '1825700', '270', '17388', '118021', '336460', '204738', 
 '46008', '124173', '1841136', '253884', '201549', '1092168', '1109397', '2054891', '455551', '24882', '42635',
 '36440', '1185653', '323692', '343265', '426968', '322493', '83876', '1725222', '1234099', '135960', '2057310',
 '204045', '2037590', '1418137', '3516', '739692', '2680', '42123', '479256', '552830', '26974', '1800607', 
 '2087162', '226016', '766803', '390661', '290005', '49785', '416630', '600615', '614043', '1855509', '118807',
 '179526', '185483', '147302', '1918955', '78660', '360477', '30635', '111055', '1158334', '2460045', '7070',
 '280016', '1863163', '6975', '347215', '1960521', '611177', '2140144', '2154792', '161619', '26718', '630005',
 '87616', '711777', '194483', '110838', '2437022', '8767', '31231', '433245', '126513', '1617449', '234885', 
 '7186', '13832', '72700', '525477', '107257', '108220', '2219638', '398028', '110639', '143357', '130472', 
 '1095933', '2048721', '1649260', '663847', '504294', '96302', '486035', '567895', '60345', '580968', '255638',
 '580962', '56597', '397249', '25720', '77020', '114688', '442400', '86504', '327762', '680237', '65864', 
 '403518', '2168920', '923628', '616631', '799861', '722137', '16241', '182447', '152942', '74136', '1808925',
 '128287', '599804', '2245027', '141597', '644978', '60018', '146482', '596320', '350509', '9402', '7989', 
 '105703', '2017085', '204070', '1813325', '53617', '41355', '24099', '9621', '218309', '17755', '1212327', 
 '1213529', '376789', '1730904', '657755', '128737', '1821192', '128046', '102899', '72915', '2070701', 
 '1197364', '459699', '168210', '123823', '1233651', '58198', '39774', '67020', '121774', '58933', '589194', 
 '147510', '17838', '20265', '2058960', '1091851', '316060', '1174831', '42845', '580393', '34893', '636984', 
 '202739', '115651', '375029', '2226712', '59005', '108458', '360392', '78656', '445726', '29111', '7195', 
 '976599', '1771836', '1863246', '552178', '1398035', '66574', '2219338', '1850877', '2558237', '1688054', 
 '13990', '311036', '717303', '66881', '1299206', '580596', '51045', '117436', '117433', '632740', '242305', 
 '45162', '79029', '458641', '73912', '16019', '2445344', '1949236', '1217562', '810411', '497849', '457686', 
 '81603', '293446', '223896', '581790', '51131', '2105126', '423685', '2459813', '514480', '135306', '212800', 
 '116748', '485066', '799929', '668230', '2093827', '2448456', '1747648', '2041411', '349665', '53375', '5294', 
 '33181', '75070', '314722', '821599', '341809', '152289', '102554', '42140', '176194', '70357', '211848', 
 '2033486', '294059', '333683', '14089', '1714690', '10507', '407206', '599612', '187467', '142179', '44221', 
 '2073801', '30186', '89943', '2485219', '99717', '529514', '506151', '316472', '112111', '35243', '470511', 
 '76518', '2382393', '646306', '769639', '2417531', '92401', '107116', '547355', '180609', '629479', '585795', 
 '552349', '144632', '157347', '692663', '1880896', '1244653', '47655', '178707', '1831351', '242059', '2601798', 
 '1342310', '66965', '1518996', '1685808', '545123', '413017', '26544', '1069176', '772110', '15336', '598854', 
 '1338711', '2064907', '710440', '261041', '1911807', '117429', '2601339', '149876', '72509', '2175291', '646050', 
 '1629953', '170471', '393528', '579018', '972609', '1787357', '120087', '36925', '447649', '114732', '1723949', 
 '889283', '57645', '120153', '678073', '140843', '2142218', '64008', '219860', '6340', '915295', '210524', 
 '293051', '485874', '64482', '767243', '57339', '303580', '1641636', '191163', '123364', '2369126', '1977907', 
 '1298792', '1239325', '2603651', '1853900', '9513', '36815', '1733321', '387734', '102284', '701274', '37693', 
 '70696', '38617', '650355', '474183', '571142', '429794', '223763', '0', '269223', '1068101', '1110466', '16478', 
 '1620749', '38762', '537512', '62236', '525234', '876443', '477240', '164206', '37740', '29287', '263785', '585307', 
 '67317', '37984', '1993347', '26726', '935415', '15819', '1880396', '2508101', '600577', '445743', '356473', 
 '145579', '379863', '77348', '1198074', '65992', '463775', '95223', '462088', '394575', '1161559', '73847', 
 '126836', '1497562', '336641', '289670', '249331', '1593029', '1790493', '132444', '108300', '50685', '2650950', 
 '373411', '35879', '398479', '194698', '355323', '2458015', '2092687', '576065', '2545481', '1879210', '1046484', 
 '17348', '46447', '222568', '110220', '460158', '119794', '2224', '121968', '122732', '498648', '220274', 
 '20875', '36372', '665336', '2453704', '335836', '248771', '42308', '125718', '1785570', '2306163', '641071', 
 '49184', '39812', '463179', '577895', '771944', '1076148', '18563', '1566273', '39708', '13093', '44759', 
 '163304', '290680', '72502', '76684', '368215', '7039', '2037029', '174775', '532065', '693773', '137823', 
 '252341', '1201659', '442162', '142423', '115114', '335224', '954028', '36745', '40851', '183377', '1715819', 
 '49994', '23129', '47674', '31544', '50852', '72214', '2037651', '2290918', '702029', '256714', '2021043', 
 '1561555', '17889', '1570253', '398086', '338611', '2197122', '91953', '163896', '1762760', '73583', '496201', 
 '992765', '87429', '1868881', '1240531', '73038', '81541', '204935', '89215', '1791687', '1727446', '39040', 
 '51324', '747709', '177149', '16205', '505519', '192699', '2073224', '244505', '77466', '1509196', '581430', 
 '56798', '1258286', '64578', '339815', '75317', '678232', '1431837', '167781', '5065', '1091685', '1328196', 
 '1787080', '1925887', '817792', '416835', '42191', '2115801', '1812726', '52143', '1221336', '605570', '12264', 
 '1958047', '90149', '506742', '368119', '1528467', '36125', '33399', '255190', '134111', '363024', '2032017', 
 '18401', '249951', '18407', '412390', '167922', '57910', '157206', '349854', '569886', '32028', '148847', 
 '1809324', '40595', '604692', '918387', '1739077', '39549', '2160865', '189868', '1775970', '143656', '78697', 
 '78696', '114899', '280888', '1829683', '1223226', '30398', '207745', '1994574', '144771', '67885', '66204', 
 '239571', '2058507', '273180', '172537', '311674', '51552', '225990', '92387', '65148', '326629', '56412', 
 '2230854', '103253', '308388', '1589042', '286254', '220650', '2656347', '2149259', '61263', '463974', 
 '498848', '65782', '580421', '1083549', '124265', '1756283', '754085', '646473', '60514', '21077', '383263', 
 '342723', '12783', '293555', '512903', '293774', '200016', '190422', '105798', '403920', '1955957', '604843', 
 '461945', '104779', '1746482', '1761782', '45775', '45992', '2551041', '1772160', '63517', '218283', '71312', 
 '149704', '1092786', '745271', '210260', '128186', '2031759', '1441107', '70950', '58346', '202896', '2030718', 
 '189987', '2560523', '1801240', '914714', '44170', '52602', '2570171', '71555', '2450835', '264060', '545279', 
 '591085', '115426', '803459', '2044134', '423982', '2413947', '775277', '493960', '2333761', '388890', '357534', 
 '955843', '2410780', '1443274', '531456', '2550029', '176459', '183136', '2468244', '2283217', '324800', '34449', 
 '91717', '289600', '2189862', '1762925', '288608', '5735', '1893919', '72235', '2341044', '967832', '2300119', 
 '1030908', '638081', '453150', '1217955', '65804', '177389', '2116832', '195605', '201359', '1586256', 
 '1104194', '1820525', '469377', '492786', '231013', '310589', '2578967', '120225', '1872174', '520871', '802726', 
 '16315', '362202', '42429', '99963', '400121', '1126477', '2261126', '43972', '60185', '699437', '2261128', 
 '1866348', '1954432', '134914', '97529', '37522', '6270', '1807955', '1734427', '320007', '1237610', '509826', 
 '1566227', '53218', '582755', '45707', '52634', '7344', '462327', '48393', '13203', '39995', '567719', '39998', 
 '939610', '53245', '102239', '45366', '36437', '1885809', '329453', '1260280', '99749', '29084', '1472673', 
 '175149', '2470397', '40116', '509975', '1866529', '109925', '960097', '54071', '58593', '837074', '571854', 
 '5359', '65344', '480483', '31282', '67441', '729941', '700845', '1516892', '15565', '39458', '39457', '3112', 
 '62019', '218725', '72823', '126301', '171733', '34495', '121498', '590293', '114388', '279763', '2219229', 
 '1984837', '1711980', '267579', '1193299', '544675', '1964801', '114161', '303196', '2572508', '110263', 
 '1263399', '2166104', '359054', '77459', '6660', '508374', '638183', '224440', '51978', '16147', '52883', 
 '1111989', '190869', '2160538', '550300', '63998', '150687', '1727743', '141630', '2487194', '524500', '56614', 
 '2511119', '70083', '118242', '223652', '563025', '339917', '1999076', '2520320', '548738', '14029', '640427', 
 '489926', '294552', '391515', '26299', '179033', '104128', '141740', '179581', '10270', '44537', '1244807', 
 '1868616', '679420', '142469', '336963', '2613209', '147104', '369239', '2581472', '2612335', '178186', '45952', 
 '37608', '565412', '137913', '37602', '2171464', '774984', '347311', '381121', '89073', '126170', '374528', 
 '76002', '1460', '2029329', '31185', '1055616', '2417302', '1850752', '2082580', '31059', '239166', '183064', 
 '1911534', '366259', '684486', '287970', '2375265', '260166', '181400', '13903', '2090921', '95293', '378164', 
 '215998', '1807056', '1193827', '16085', '854589', '195713', '448939', '452801', '181135', '1775543', '148243', 
 '1727750', '593205', '484953', '43915', '24920', '46140', '96069', '42393', '272085', '686427', '246543', 
 '293214', '292618', '1496663', '1751822', '550680', '473365', '327035', '1778081', '97349', '2544076', '564738', 
 '1300763', '572652', '260151', '1342076', '596184', '17593', '2070367', '821986', '1868697', '1260731', '45037', 
 '636698', '1042773', '423882', '2014204', '399410', '462269', '68457', '190389', '1952584', '121448', '315624', 
 '737819', '470034', '26787', '715957', '419938', '1264399', '590907', '257555', '39504', '2368676', '18794', 
 '670969', '758179', '40397', '29465', '749611', '2581047', '1679', '567517', '35379', '336822', '78630', 
 '66391', '571899', '280354', '342832', '2045767', '2148079', '90528', '1153613', '67602', '29517', '577339', 
 '88429', '1486839', '340221', '586162', '67862', '1867476', '2463312', '1533538', '1800919', '35618', '19192', 
 '69860', '507276', '549458', '1950297', '177351', '257305', '88204', '110046', '277315', '1199368', '1702611', 
 '832168', '2482522', '1775204', '842400', '589003', '362526', '579793', '140216', '244289', '374845', '476078', 
 '85218', '1906763', '10927', '550560', '986987', '39878', '1153292', '2290271', '21968', '53064', '810478', 
 '994422', '377482', '69735', '349953', '5164', '128017', '622505', '14002', '644905', '376605', '218240', 
 '124550', '386788', '1977785', '437391', '167950', '2498526', '113824', '58380', '1280985', '96935', '45731', 
 '1595434', '415250', '337388', '115377', '2071227', '526918', '1704648', '176936', '2298333', '68733', '229590', 
 '357952', '12982', '2322307', '26685', '343045', '528993', '225129', '83303', '913903', '863007', '267619', 
 '415922', '1865421', '40527', '492082', '2104557', '114354', '492311', '2025191', '1910640', '34023', '541988', 
 '531849', '282726', '1974876', '22542', '580389', '105861', '405966', '170368', '188789', '2063408', '431867', 
 '361479', '1679807', '580496', '81476', '1968022', '35402', '116463', '1984358', '118112', '119410', '1065962', 
 '27348', '561901', '1399112', '335935', '1929839', '99325', '95453', '1712609', '116887', '13378', '46160', 
 '2586170', '80256', '1906336', '915322', '1033527', '349785', '47562', '2468592', '75154', '2380336', '309463', 
 '2451678', '716608', '102905', '123918', '1869781', '118856', '46830', '34838', '1798870', '36694', '113744', 
 '480737', '2368611', '40738', '33267', '364347', '15748', '1843525', '922980', '1784781', '57844', '78185', 
 '13023', '701697', '78613', '793389', '85971', '18069', '37833', '2831', '461910', '607498', '28000', '2018518', 
 '569138', '2268591', '597165', '1814993', '267286', '214906', '2044188', '149097', '1540922', '1279425', '212207', 
 '180657', '359714', '359477', '11238', '71557', '312420', '67931', '192347', '103238', '2548803', '239080', 
 '56490', '953009', '2163151', '2610594', '35560', '127584', '340010', '109035', '378000', '50624', '881429', 
 '120673', '1618096', '19889', '135012', '78986', '69628', '101109', '358380', '372615', '396743', '592418', 
 '320788', '302684', '534961', '90687', '352869', '85098', '90689', '444870', '118048', '679886', '563260', 
 '312319', '466876', '60756', '75147', '1084821', '42619', '125179', '944329', '2010249', '33498', '2053406', 
 '24121', '46800', '336039', '772031', '584951', '1643116', '2626454', '192403', '1204736', '1028278', '4499', 
 '321302', '675430', '167841', '947808', '2078700', '774941', '416653', '30652', '44310', '585999', '213831', 
 '193020', '1039170', '44089', '175063', '2377191', '7094', '1724007', '172817', '1223146', '147674', '416346', 
 '503566', '39330', '411224', '606535', '76097', '1790085', '2019019', '672441', '132740', '577766', '287354', 
 '1851521', '378124', '272351', '219421', '2058027', '7471', '55171', '463879', '813164', '155277', '118623', 
 '145231', '26348', '88763', '523139', '43248', '2003234', '497567', '221215', '103885', '896371', '87483', 
 '1728043', '240117', '60567', '1363862', '192740', '249676', '1534842', '973600', '23857', '327780', '118134', 
 '1204251', '88164', '1398999', '1997460', '220313', '744550', '51876', '502573', '1511851', '423588', '1996683', 
 '16268', '333132', '162465', '332966', '472811', '1814503', '270456', '672845', '87221', '101958', '121530', 
 '172005', '523940', '826912', '64911', '858776', '2209894', '820760', '211966', '2584726', '62296', '39688', 
 '332033', '504987', '1420318', '133774', '202978', '68415', '491648', '75046', '2675', '418559', '708425', 
 '15720', '1863779', '264298', '506727', '571344', '775150', '789491', '338902', '1080307', '33665', '142764', 
 '811152', '402914', '44091', '15657', '47978', '29558', '426574', '346364', '636439', '333740', '445671', 
 '113089', '273343', '662484', '1782960', '174432', '129531', '104931', '178444', '1749387', '1766030', '217070', 
 '126278', '34543', '483477', '361718', '136055', '2194555', '1943397', '92274', '519210', '87818', '705725', 
 '5635', '87761', '686968', '789766', '47757', '2026048', '221365'])
 ,
1435
"""